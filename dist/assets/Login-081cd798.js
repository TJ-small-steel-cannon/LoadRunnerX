import{o as H,u as J,r as g,a as m,c as O,b as Q,d as W,e as Y,f as d,g as o,w as s,E as L,h as ee,i as _,j as k,l as R,k as oe,m as v,t as T,s as le,n as te,p as se,q as ae,v as de,x as ie,y as re,z as ne,A as ue}from"./index-4ff56a06.js";import{s as me}from"./index-48071e1a.js";import{u as ce}from"./jsencrypt.min-07a97c17.js";import{s as $}from"./request-d4e7de7f.js";import{d as pe,e as fe}from"./jsencrpyt-f8a7432b.js";import"./axios-47b9d439.js";function ge(){return $({url:"/valida_code/get_picture",headers:{isToken:!1},method:"get",timeout:2e4})}function _e(z){return $({url:"/login",headers:{isToken:!1},method:"post",timeout:1e4,data:z})}const be={class:"login"},he={class:"loginContainer"},ve=d("span",{class:"title"},"欢迎登录 LoadRunnerX 压力测试平台",-1),xe={class:"codeImg"},ye={class:"codeInput"},we={class:"operate"},Ve={class:"codeImg"},Ie={class:"codeInput"},Ce={class:"phoneCode"},ke=d("div",{class:"divider"},null,-1),Re={class:"codeImg"},Te={class:"codeInput"},ze={class:"emailCode"},Fe=d("div",{class:"divider"},null,-1),Ne={class:"publicModule"},Pe={class:"gotoRegister"},Se={__name:"Login",setup(z){H(()=>{c("account"),c("phone"),c("email")});const B=J(),b=ce(),y=g(null),F=g(null),N=g(null);g("");const i=m({isRememberPassword:b.userInfo.isRememberPassword,userName:b.userInfo.userName,password:pe(b.userInfo.password),code:"",uuid:"",codeImg:""}),n=m({phone:"",uuid:"",code:"",phoneCode:"",codeImg:""}),u=m({email:"",code:"",emailCode:"",codeImg:"",uuid:""}),h=g("account"),E=m({userName:[{required:!0,message:"请输入用户名!",trigger:"change"}],password:[{required:!0,message:"请输入密码!",trigger:"change"}],code:[{required:!0,message:"请输入验证码!",trigger:"change"}]}),S=m({phone:[{required:!0,message:"请输入手机号码!",trigger:"change"},{validator(l,e,a){!/^1[3-9]\d{9}$/.test(e)&&e!=""?(f.disabled=!0,a(new Error("请输入正确手机号"))):(e==""?f.disabled=!0:f.disabled=!1,a())},trigger:"change"}],code:[{required:!0,message:"请输入验证码!",trigger:"change"}],phoneCode:[{required:!0,message:"请输入验证码!",trigger:"change"}]}),A=m({email:[{required:!0,message:"请输入邮箱!",trigger:"change"},{validator(l,e,a){!/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{3,4})$/.test(e)&&e!=""?(p.disabled=!0,a(new Error("请输入正确邮箱"))):(e==""?p.disabled=!0:p.disabled=!1,a())},trigger:"change"}],code:[{required:!0,message:"请输入验证码!",trigger:"change"}],emailCode:[{required:!0,message:"请输入验证码!",trigger:"change"}]}),x=g(!1),Z=(l,e)=>{console.log(l,e)};function P(){h.value=="account"?y.value.validate(l=>{if(l){x.value=!0;const e={userName:i.userName,userPassword:i.password,vcPictureCode:{result:i.code,vcId:i.uuid}};_e(e).then(a=>{if(a.code==200){if(i.isRememberPassword){const r={...i,password:fe(i.password),code:""};b.setuserInfo(r)}else{const r={userName:"",password:"",isRememberPassword:!1};b.setuserInfo(r)}le(a.uuid),B.replace("/index")}}).catch(a=>{console.log("errMsg--->",a.message),c("account")}).finally(()=>{x.value=!1})}}):h.value=="phone"?F.value.validate(l=>{}):h.value=="email"&&N.value.validate(l=>{})}function c(l){ge().then(e=>{console.log(e),e.code==200&&(l=="account"?(i.codeImg="data:image/gif;base64,"+e.base64Img,i.uuid=e.vcId):l=="phone"?(n.codeImg="data:image/gif;base64,"+e.base64Img,n.uuid=e.vcId):l=="email"&&(u.codeImg="data:image/gif;base64,"+e.base64Img,u.uuid=e.vcId))})}const p=m({type:"primary",btnText:"获取验证码",disabled:!0}),f=m({type:"primary",btnText:"获取验证码",disabled:!0});function M(l){l.type="",l.disabled=!0,l.btnText="请稍候...",setTimeout(()=>{K(60,l)},500)}function K(l,e){me("验证码已发送!"),l=l||60,e.btnText=l+"s后获取",setTimeout(()=>{l>0&&(e.btnText=l+"s后获取",--l)},1e3);let a=setInterval(()=>{l>0?(e.btnText=l+"s后获取",--l):(e.btnText="获取验证码",e.disabled=!1,e.type="primary",clearInterval(a))},1e3)}const j=O(()=>l=>l?"登录中":"登录");return(l,e)=>{const a=te,r=se,w=ae,V=de,D=ie,U=re,q=Q("router-link"),I=ne,C=ue,X=L,G=ee;return W(),Y("div",be,[d("div",he,[ve,o(X,{modelValue:h.value,"onUpdate:modelValue":e[16]||(e[16]=t=>h.value=t),class:"tabs",onTabClick:Z},{default:s(()=>[o(I,{label:"密码登陆",name:"account"},{default:s(()=>[o(V,{model:i,ref_key:"accountFormRef",ref:y,rules:E,style:{width:"100%"}},{default:s(()=>[o(r,{prop:"userName"},{default:s(()=>[o(a,{modelValue:i.userName,"onUpdate:modelValue":e[0]||(e[0]=t=>i.userName=t),modelModifiers:{trim:!0},placeholder:"请输入用户名",clearable:"","prefix-icon":_(k),size:"large",style:{width:"100%"}},null,8,["modelValue","prefix-icon"])]),_:1}),o(r,{prop:"password"},{default:s(()=>[o(a,{modelValue:i.password,"onUpdate:modelValue":e[1]||(e[1]=t=>i.password=t),modelModifiers:{trim:!0},placeholder:"请输入密码",type:"password",clearable:"","prefix-icon":_(R),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1}),o(r,{prop:"code"},{default:s(()=>[d("div",xe,[d("div",ye,[o(a,{modelValue:i.code,"onUpdate:modelValue":e[2]||(e[2]=t=>i.code=t),modelModifiers:{trim:!0},placeholder:"请输入验证码",clearable:"",size:"large",onKeydown:e[3]||(e[3]=oe(t=>P(y.value),["enter"])),maxlength:"6"},null,8,["modelValue"])]),d("div",{class:"codePicture",onClick:e[4]||(e[4]=t=>c("account"))},[o(w,{style:{width:"100%",height:"100%"},src:i.codeImg,fit:"fill"},null,8,["src"])])])]),_:1})]),_:1},8,["model","rules"]),d("div",we,[d("div",null,[o(D,{modelValue:i.isRememberPassword,"onUpdate:modelValue":e[5]||(e[5]=t=>i.isRememberPassword=t),label:"记住密码",size:"small"},null,8,["modelValue"])]),d("div",null,[o(q,{to:"/member/retrievePassword"},{default:s(()=>[o(U,null,{default:s(()=>[v("忘记密码?")]),_:1})]),_:1})])])]),_:1}),o(I,{label:"短信登录",name:"phone"},{default:s(()=>[o(V,{model:n,ref_key:"phoneFormRef",ref:F,rules:S,style:{width:"100%"}},{default:s(()=>[o(r,{prop:"phone"},{default:s(()=>[o(a,{modelValue:n.phone,"onUpdate:modelValue":e[6]||(e[6]=t=>n.phone=t),modelModifiers:{trim:!0},placeholder:"请输入手机号",clearable:"","prefix-icon":_(k),size:"large",style:{width:"100%"}},null,8,["modelValue","prefix-icon"])]),_:1}),o(r,{prop:"code"},{default:s(()=>[d("div",Ve,[d("div",Ie,[o(a,{modelValue:n.code,"onUpdate:modelValue":e[7]||(e[7]=t=>n.code=t),modelModifiers:{trim:!0},placeholder:"请输入验证码",clearable:"",size:"large",maxlength:"6"},null,8,["modelValue"])]),d("div",{class:"codePicture",onClick:e[8]||(e[8]=t=>c("phone"))},[o(w,{style:{width:"100%",height:"100%"},src:n.codeImg,fit:"fill"},null,8,["src"])])])]),_:1}),o(r,{prop:"phoneCode"},{default:s(()=>[d("div",Ce,[o(a,{modelValue:n.phoneCode,"onUpdate:modelValue":e[9]||(e[9]=t=>n.phoneCode=t),modelModifiers:{trim:!0},placeholder:"请输入验证码",type:"password","prefix-icon":_(R),size:"large",maxlength:"6"},null,8,["modelValue","prefix-icon"]),ke,o(C,{link:"",type:f.type,class:"btnCode",disabled:f.disabled||n.code.length==0,onClick:e[10]||(e[10]=t=>M(f))},{default:s(()=>[v(T(f.btnText),1)]),_:1},8,["type","disabled"])])]),_:1})]),_:1},8,["model","rules"])]),_:1}),o(I,{label:"邮箱登陆",name:"email"},{default:s(()=>[o(V,{model:u,ref_key:"emailFormRef",ref:N,rules:A,style:{width:"100%"}},{default:s(()=>[o(r,{prop:"email"},{default:s(()=>[o(a,{modelValue:u.email,"onUpdate:modelValue":e[11]||(e[11]=t=>u.email=t),modelModifiers:{trim:!0},placeholder:"请输入邮箱",clearable:"","prefix-icon":_(k),size:"large",style:{width:"100%"}},null,8,["modelValue","prefix-icon"])]),_:1}),o(r,{prop:"code"},{default:s(()=>[d("div",Re,[d("div",Te,[o(a,{modelValue:u.code,"onUpdate:modelValue":e[12]||(e[12]=t=>u.code=t),modelModifiers:{trim:!0},placeholder:"请输入验证码",clearable:"",size:"large",maxlength:"6"},null,8,["modelValue"])]),d("div",{class:"codePicture",onClick:e[13]||(e[13]=t=>c("email"))},[o(w,{style:{width:"100%",height:"100%"},src:u.codeImg,fit:"fill"},null,8,["src"])])])]),_:1}),o(r,{prop:"emailCode"},{default:s(()=>[d("div",ze,[o(a,{modelValue:u.emailCode,"onUpdate:modelValue":e[14]||(e[14]=t=>u.emailCode=t),modelModifiers:{trim:!0},placeholder:"请输入验证码",type:"password","prefix-icon":_(R),size:"large",maxlength:"6"},null,8,["modelValue","prefix-icon"]),Fe,o(C,{link:"",type:p.type,class:"btnCode",disabled:p.disabled||u.code==0,onClick:e[15]||(e[15]=t=>M(p))},{default:s(()=>[v(T(p.btnText),1)]),_:1},8,["type","disabled"])])]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["modelValue"]),d("div",Ne,[o(G,{direction:"vertical",size:15,alignment:"normal",style:{width:"100%"}},{default:s(()=>[o(C,{type:"primary",size:"large",class:"loginBtn",onClick:P,loading:x.value},{default:s(()=>[v(T(j.value(x.value)),1)]),_:1},8,["loading"]),d("div",Pe,[o(q,{to:"/member/register"},{default:s(()=>[o(U,{type:"primary"},{default:s(()=>[v("没有账号我要免费注册>>")]),_:1})]),_:1})])]),_:1})])])])}}};export{Se as default};
