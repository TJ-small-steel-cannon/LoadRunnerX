import{u as Y,r as v,a as f,B as F,b as L,d as T,e as ee,f as _,g as t,w as l,i as n,C as te,D as oe,F as S,G as le,H as re,E as ae,y as se,j as ne,l as E,m as g,I as ie,t as Z,J as de,K as O,L as M,M as me,n as pe,p as ue,A as ce,v as fe,z as ge,N as _e,O as we}from"./index-9a8e5c53.js";import{u as he,s as $}from"./jsencrypt.min-6ff93236.js";/* empty css                     */import{C as D,s as ye}from"./success8-b7f07ad9.js";import{s as U,e as xe}from"./jsencrpyt-5cb8fdf4.js";import"./axios-47b9d439.js";function be(y){return U({url:"/register",headers:{isToken:!1},method:"post",data:y})}function ve(y){return U({url:"/valida_code/get_email",headers:{isToken:!1},method:"get",params:y})}function Ve(y){return U({url:"/valida_code/get_phone",headers:{isToken:!1},method:"get",params:y})}const Te={class:"register"},Ce={class:"registerContainer"},Ne=_("span",{class:"title"},"注册 LoadRunnerX 压力测试平台",-1),ze={class:"emailCode"},Re=_("div",{class:"divider"},null,-1),Se={class:"phoneCode"},Ue=_("div",{class:"divider"},null,-1),Ae={style:{width:"100%","min-height":"272px",display:"flex","flex-direction":"column","align-items":"center"}},ke=["src"],Ze={__name:"Register",setup(y){const G=he();Y();const j=v(ye+"?"+ +new Date);let p=v(0);const A=v(null),k=v(null),C=v(null),i=f({userName:"",password:"",confirmPassword:""}),s=f({email:"",emailCode:"",emailUUID:"",phone:"",phoneCode:"",phoneUUID:""}),u=f({problemOne:"",answerOne:"",problemTwo:"",answerTwo:""}),H=f({userName:[{required:!0,message:"请输入用户名!",trigger:"change"},{validator(o,e,r){/^[a-zA-Z][a-zA-Z0-9_]{2,15}$/.test(e)?r():r(new Error("账号必须是字母开头，可以包含字母、数字、下划线，长度在3到16个字符之间"))},trigger:"change"}],password:[{required:!0,message:"请输入密码!",trigger:"change"},{validator(o,e,r){/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,18}$/.test(e)?r():r(new Error("密码可以由字母、数字、下划线组成，至少包含一个字母和一个数字，长度在8到16个字符之间"))},trigger:"change"}],confirmPassword:[{required:!0,message:"请再次输入密码!",trigger:"change"},{validator(o,e,r){e!=i.password?r(new Error("两次密码输入不相符")):r()},trigger:"change"}]}),J=f({email:[{validator(o,e,r){!/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{3,4})$/.test(e)&&e!=""?(w.disabled=!0,r(new Error("请输入正确邮箱"))):(e==""?w.disabled=!0:w.disabled=!1,r())},trigger:"change"}],emailCode:[{validator(o,e,r){const d=/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{3,4})$/;d.test(s.email)&&e.length!=4?r(new Error("请正确输入邮箱验证码")):!d.test(s.email)&&e.length!=0?r(new Error("请勿输入验证码")):r()},trigger:"change"}],phone:[{validator(o,e,r){!/^1[3-9]\d{9}$/.test(e)&&e!=""?(h.disabled=!0,r(new Error("请输入正确手机号"))):(e==""?h.disabled=!0:h.disabled=!1,r())},trigger:"change"}],phoneCode:[{validator(o,e,r){const d=/^1[3-9]\d{9}$/;d.test(s.phone)&&e.length!=4?r(new Error("请正确输入手机验证码")):!d.test(s.phone)&&e.length!=0?r(new Error("请勿输入验证码")):r()},trigger:"change"}]}),K=f({problemOne:[{required:!0,message:"请输入密保问题一",trigger:"change"}],answerOne:[{required:!0,message:"请输入密保答案一",trigger:"change"}],problemTwo:[{required:!0,message:"请输入密保问题二",trigger:"change"}],answerTwo:[{required:!0,message:"请输入密保答案二",trigger:"change"}]}),w=f({type:"primary",btnText:"获取验证码",disabled:!0}),h=f({type:"primary",btnText:"获取验证码",disabled:!0});let x=f({state:!1,text:"注册中"});function N(o){o.validate(e=>{if(e)if(o==C.value){x.state=!0,x.text="注册中";const r={userName:i.userName,userPassword:i.password,userSecProblem1:u.problemOne,userSecProblem2:u.problemTwo,userSecAnswer1:u.answerOne,userSecAnswer2:u.answerTwo,userSysEmail:s.email,vcEmailCode:{validation:s.emailCode,vcId:s.emailUUID},userTelephone:s.phone,vcTelephoneCode:{validation:s.phoneCode,vcId:s.phoneUUID}};be(r).then(d=>{if(d.code==200){$("注册成功"),p.value=4,x.state=!1,x.text="注册";const c={userName:i.userName,password:xe(i.password),isRememberPassword:!0};G.setuserInfo(c)}else console.log("err-->",d)})}else p.value++})}function X(){p.value--}function I(o){o.type="",o.disabled=!0,o.btnText="请稍候...",o==h?Ve({phoneNum:s.phone}).then(e=>{e.code==200&&(setTimeout(()=>{B(60,o)},500),s.phoneUUID=e.vcId)}):o==w&&ve({emailAddr:s.email}).then(e=>{e.code==200&&(setTimeout(()=>{B(60,o)},500),s.emailUUID=e.vcId)})}function B(o,e){$("验证码已发送!"),o=o||60,e.btnText=o+"s后获取",setTimeout(()=>{o>0&&(e.btnText=o+"s后获取",--o)},1e3);let r=setInterval(()=>{o>0?(e.btnText=o+"s后获取",--o):(e.btnText="获取验证码",e.disabled=!1,e.type="primary",clearInterval(r))},1e3)}return F(()=>i.userName,(o,e)=>{const r=/^[a-zA-Z][a-zA-Z0-9_]{2,15}$/;o.length==1?document.querySelector(".user_name").parentNode.parentNode.style.marginBottom="29px":o.length==0||r.test(o)?document.querySelector(".user_name").parentNode.parentNode.style.marginBottom="18px":document.querySelector(".user_name").parentNode.parentNode.style.marginBottom="29px"}),F(()=>i.password,(o,e)=>{const r=/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,18}$/;o.length==1?document.querySelector(".password").parentNode.parentNode.style.marginBottom="41px":o.length==0||r.test(o)?document.querySelector(".password").parentNode.parentNode.style.marginBottom="18px":document.querySelector(".password").parentNode.parentNode.style.marginBottom="41px"}),(o,e)=>{const r=me,d=re,c=pe,m=ue,b=ce,z=fe,V=ge,P=_e,Q=we,W=ae,R=se,q=L("router-link");return T(),ee("div",Te,[_("div",Ce,[Ne,t(d,{active:n(p),"finish-status":"success","process-status":"finish","align-center":"",space:100,class:"register_steps"},{default:l(()=>[t(r,{title:"填写账号密码"}),t(r,{title:"绑定邮箱/手机号"}),t(r,{title:"设置密保"}),t(r,{title:"完成注册"})]),_:1},8,["active"]),t(W,{modelValue:n(p),"onUpdate:modelValue":e[16]||(e[16]=a=>te(p)?p.value=a:p=a),class:"tabs"},{default:l(()=>[t(V,{name:0},{default:l(()=>[t(z,{model:i,ref_key:"accountFormRef",ref:A,rules:H,class:"myForm"},{default:l(()=>[t(m,{prop:"userName"},{default:l(()=>[t(c,{modelValue:i.userName,"onUpdate:modelValue":e[0]||(e[0]=a=>i.userName=a),modelModifiers:{trim:!0},placeholder:"请输入用户名",clearable:"","prefix-icon":n(ne),size:"large",class:"user_name"},null,8,["modelValue","prefix-icon"])]),_:1}),t(m,{prop:"password"},{default:l(()=>[t(c,{modelValue:i.password,"onUpdate:modelValue":e[1]||(e[1]=a=>i.password=a),modelModifiers:{trim:!0},placeholder:"请输入密码",type:"password",class:"password",clearable:"","show-password":"","prefix-icon":n(E),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1}),t(m,{prop:"confirmPassword"},{default:l(()=>[t(c,{modelValue:i.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=a=>i.confirmPassword=a),modelModifiers:{trim:!0},placeholder:"请再次输入密码",type:"password",clearable:"","show-password":"","prefix-icon":n(E),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1}),t(m,null,{default:l(()=>[t(b,{type:"primary",size:"large",style:{width:"100%"},onClick:e[3]||(e[3]=a=>N(A.value))},{default:l(()=>[g(" 下一步")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1}),t(V,{name:1},{default:l(()=>[t(z,{model:s,ref_key:"emailPhoneFormRef",ref:k,rules:J,class:"myForm"},{default:l(()=>[t(m,{prop:"email"},{default:l(()=>[t(P,{class:"box-item",effect:"dark",content:"如不需绑定邮箱不要填写直接下一步即可",placement:"top"},{default:l(()=>[t(c,{modelValue:s.email,"onUpdate:modelValue":e[4]||(e[4]=a=>s.email=a),modelModifiers:{trim:!0},placeholder:"请输入邮箱地址",clearable:"","prefix-icon":n(ie),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),t(m,{prop:"emailCode"},{default:l(()=>[_("div",ze,[t(c,{modelValue:s.emailCode,"onUpdate:modelValue":e[5]||(e[5]=a=>s.emailCode=a),modelModifiers:{trim:!0},placeholder:"请输入邮箱验证码","prefix-icon":D,size:"large",maxlength:"4"},null,8,["modelValue"]),Re,t(b,{link:"",type:w.type,class:"btnCode",disabled:w.disabled,onClick:e[6]||(e[6]=a=>I(w))},{default:l(()=>[g(Z(w.btnText),1)]),_:1},8,["type","disabled"])])]),_:1}),t(m,{prop:"phone"},{default:l(()=>[t(P,{class:"box-item",effect:"dark",content:"如不需绑定手机不要填写直接下一步即可",placement:"top"},{default:l(()=>[t(c,{modelValue:s.phone,"onUpdate:modelValue":e[7]||(e[7]=a=>s.phone=a),modelModifiers:{trim:!0},placeholder:"请输入手机号",clearable:"","prefix-icon":n(de),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),t(m,{prop:"phoneCode"},{default:l(()=>[_("div",Se,[t(c,{modelValue:s.phoneCode,"onUpdate:modelValue":e[8]||(e[8]=a=>s.phoneCode=a),modelModifiers:{trim:!0},placeholder:"请输入手机验证码","prefix-icon":D,size:"large",maxlength:"4"},null,8,["modelValue"]),Ue,t(b,{link:"",type:h.type,class:"btnCode",disabled:h.disabled,onClick:e[9]||(e[9]=a=>I(h))},{default:l(()=>[g(Z(h.btnText),1)]),_:1},8,["type","disabled"])])]),_:1}),t(m,null,{default:l(()=>[t(b,{type:"primary",size:"large",style:{width:"100%"},onClick:e[10]||(e[10]=a=>N(k.value))},{default:l(()=>[g(" 下一步")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1}),t(V,{name:2},{default:l(()=>[t(z,{model:u,ref_key:"confidentialityFormRef",ref:C,rules:K,class:"myForm"},{default:l(()=>[t(m,{prop:"problemOne"},{default:l(()=>[t(c,{modelValue:u.problemOne,"onUpdate:modelValue":e[11]||(e[11]=a=>u.problemOne=a),modelModifiers:{trim:!0},placeholder:"请输入密保问题一",clearable:"","prefix-icon":n(O),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1}),t(m,{prop:"answerOne"},{default:l(()=>[t(c,{modelValue:u.answerOne,"onUpdate:modelValue":e[12]||(e[12]=a=>u.answerOne=a),modelModifiers:{trim:!0},placeholder:"请输入密保问题答案一",clearable:"","prefix-icon":n(M),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1}),t(m,{prop:"problemTwo"},{default:l(()=>[t(c,{modelValue:u.problemTwo,"onUpdate:modelValue":e[13]||(e[13]=a=>u.problemTwo=a),modelModifiers:{trim:!0},placeholder:"请输入密保问题二",clearable:"","prefix-icon":n(O),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1}),t(m,{prop:"answerTwo"},{default:l(()=>[t(c,{modelValue:u.answerTwo,"onUpdate:modelValue":e[14]||(e[14]=a=>u.answerTwo=a),modelModifiers:{trim:!0},placeholder:"请输入密保问题答案二","prefix-icon":n(M),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1}),t(m,null,{default:l(()=>[t(b,{type:"primary",size:"large",style:{width:"100%"},onClick:e[15]||(e[15]=a=>N(C.value)),loading:n(x).state},{default:l(()=>[g(" 注册")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])]),_:1}),t(V,{name:4},{default:l(()=>[_("div",Ae,[t(Q,{type:"success"},{default:l(()=>[g("注册成功！")]),_:1}),_("img",{src:j.value,width:"100",height:"100",alt:"Girl has dropped her ice cream."},null,8,ke)])]),_:1})]),_:1},8,["modelValue"]),_("div",{class:"gotoLogin",style:oe({justifyContent:n(p)>0&&n(p)!=4?"space-between":"right"})},[n(p)>0&&n(p)!=4?(T(),S(R,{key:0,type:"primary",onClick:X},{default:l(()=>[g("上一步")]),_:1})):le("",!0),n(p)!=4?(T(),S(q,{key:1,to:"/member/login"},{default:l(()=>[t(R,{type:"primary"},{default:l(()=>[g("已有账号去登录>>")]),_:1})]),_:1})):(T(),S(q,{key:2,to:"/member/login"},{default:l(()=>[t(R,{type:"primary"},{default:l(()=>[g("立即登录>>")]),_:1})]),_:1}))],4)])])}}};export{Ze as default};
