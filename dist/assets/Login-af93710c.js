import{o as J,u as O,r as f,a as i,c as Q,b as W,d as Y,e as L,f as n,g as l,w as t,E as ee,h as oe,i as c,j as R,l as C,k as le,m as v,t as T,s as te,n as se,p as ae,q as re,v as ne,x as de,y as ie,z as ue,A as me}from"./index-4bd3311b.js";import{u as ce,s as pe}from"./jsencrypt.min-6e33a064.js";import{s as E,d as fe,e as _e}from"./jsencrpyt-fe17c7f4.js";import"./axios-47b9d439.js";function ge(){return E({url:"/valida_code/get_picture",headers:{isToken:!1},method:"get",timeout:2e4})}function be(I){return E({url:"/login",headers:{isToken:!1},method:"post",timeout:1e4,data:I})}const ve={class:"login"},he={class:"loginContainer"},ye=n("span",{class:"title"},"欢迎登录 LoadRunnerX 压力测试平台",-1),we={class:"codeImg"},xe={class:"codeInput"},Ve={class:"operate"},ke={class:"phoneCode"},Re=n("div",{class:"divider"},null,-1),Ce={class:"emailCode"},Te=n("div",{class:"divider"},null,-1),Ie={class:"publicModule"},ze={class:"gotoRegister"},Ue={__name:"Login",setup(I){J(()=>{w()});const q=O(),p=ce(),y=f(null),z=f(null),F=f(null);let N=f("");const r=i({isRememberPassword:p.userInfo.isRememberPassword,userName:p.userInfo.userName,password:fe(p.userInfo.password),code:p.userInfo.code,uuid:""}),_=i({phone:"",code:""}),g=i({email:"",code:""}),b=f("account"),S=i({userName:[{required:!0,message:"请输入用户名!",trigger:"change"}],password:[{required:!0,message:"请输入密码!",trigger:"change"}],code:[{required:!0,message:"请输入验证码!",trigger:"change"}]}),$=i({phone:[{validator(o,e,s){!/^1[3-9]\d{9}$/.test(e)&&e!=""?(m.disabled=!0,s(new Error("请输入正确手机号"))):(e==""?m.disabled=!0:m.disabled=!1,s())},trigger:"change"}],code:[{required:!0,message:"请输入验证码!",trigger:"change"}]}),A=i({email:[{validator(o,e,s){!/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{3,4})$/.test(e)&&e!=""?(u.disabled=!0,s(new Error("请输入正确邮箱"))):(e==""?u.disabled=!0:u.disabled=!1,s())},trigger:"change"}],code:[{required:!0,message:"请输入验证码!",trigger:"change"}]}),h=f(!1),Z=(o,e)=>{console.log(o,e)};function M(){b.value=="account"?y.value.validate(o=>{if(o){h.value=!0;const e={username:r.userName,password:r.password,code:r.code,uuid:r.uuid};be(e).then(s=>{if(s.code==200){if(r.isRememberPassword){const d={...r,password:_e(r.password),code:""};p.setuserInfo(d)}else{const d={userName:"",password:"",isRememberPassword:!1};p.setuserInfo(d)}te(s.token),q.replace("/index")}}).catch(s=>{console.log("errMsg--->",s.message),w()}).finally(()=>{h.value=!1})}}):b.value=="phone"?z.value.validate(o=>{}):b.value=="email"&&F.value.validate(o=>{})}function w(){ge().then(o=>{console.log(o),o.code==200&&(N.value="data:image/gif;base64,"+o.base64Img,r.uuid=o.vcId)})}const u=i({type:"primary",btnText:"获取验证码",disabled:!0}),m=i({type:"primary",btnText:"获取验证码",disabled:!0});function P(o){o.type="",o.disabled=!0,o.btnText="请稍候...",setTimeout(()=>{K(60,o)},500)}function K(o,e){pe("验证码已发送!"),o=o||60,e.btnText=o+"s后获取",setTimeout(()=>{o>0&&(e.btnText=o+"s后获取",--o)},1e3);let s=setInterval(()=>{o>0?(e.btnText=o+"s后获取",--o):(e.btnText="获取验证码",e.disabled=!1,e.type="primary",clearInterval(s))},1e3)}const j=Q(()=>o=>o?"登录中":"登录");return(o,e)=>{const s=se,d=ae,D=re,x=ne,X=de,U=ie,B=W("router-link"),V=ue,k=me,G=ee,H=oe;return Y(),L("div",ve,[n("div",he,[ye,l(G,{modelValue:b.value,"onUpdate:modelValue":e[11]||(e[11]=a=>b.value=a),class:"tabs",onTabClick:Z},{default:t(()=>[l(V,{label:"密码登陆",name:"account"},{default:t(()=>[l(x,{model:r,ref_key:"accountFormRef",ref:y,rules:S,style:{width:"100%"}},{default:t(()=>[l(d,{prop:"userName"},{default:t(()=>[l(s,{modelValue:r.userName,"onUpdate:modelValue":e[0]||(e[0]=a=>r.userName=a),modelModifiers:{trim:!0},placeholder:"请输入用户名",clearable:"","prefix-icon":c(R),size:"large",style:{width:"100%"}},null,8,["modelValue","prefix-icon"])]),_:1}),l(d,{prop:"password"},{default:t(()=>[l(s,{modelValue:r.password,"onUpdate:modelValue":e[1]||(e[1]=a=>r.password=a),modelModifiers:{trim:!0},placeholder:"请输入密码",type:"password",clearable:"","prefix-icon":c(C),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1}),l(d,{prop:"code"},{default:t(()=>[n("div",we,[n("div",xe,[l(s,{modelValue:r.code,"onUpdate:modelValue":e[2]||(e[2]=a=>r.code=a),modelModifiers:{trim:!0},placeholder:"请输入验证码",clearable:"",size:"large",onKeydown:e[3]||(e[3]=le(a=>M(y.value),["enter"]))},null,8,["modelValue"])]),n("div",{class:"codePicture",onClick:w},[l(D,{style:{width:"100%",height:"100%"},src:c(N),fit:"fill"},null,8,["src"])])])]),_:1})]),_:1},8,["model","rules"]),n("div",Ve,[n("div",null,[l(X,{modelValue:r.isRememberPassword,"onUpdate:modelValue":e[4]||(e[4]=a=>r.isRememberPassword=a),label:"记住密码",size:"small"},null,8,["modelValue"])]),n("div",null,[l(B,{to:"/member/retrievePassword"},{default:t(()=>[l(U,null,{default:t(()=>[v("忘记密码?")]),_:1})]),_:1})])])]),_:1}),l(V,{label:"短信登录",name:"phone"},{default:t(()=>[l(x,{model:_,ref_key:"phoneFormRef",ref:z,rules:$,style:{width:"100%"}},{default:t(()=>[l(d,{prop:"phone"},{default:t(()=>[l(s,{modelValue:_.phone,"onUpdate:modelValue":e[5]||(e[5]=a=>_.phone=a),modelModifiers:{trim:!0},placeholder:"请输入手机号",clearable:"","prefix-icon":c(R),size:"large",style:{width:"100%"}},null,8,["modelValue","prefix-icon"])]),_:1}),l(d,{prop:"code"},{default:t(()=>[n("div",ke,[l(s,{modelValue:_.code,"onUpdate:modelValue":e[6]||(e[6]=a=>_.code=a),modelModifiers:{trim:!0},placeholder:"请输入验证码",type:"password","prefix-icon":c(C),size:"large"},null,8,["modelValue","prefix-icon"]),Re,l(k,{link:"",type:m.type,class:"btnCode",disabled:m.disabled,onClick:e[7]||(e[7]=a=>P(m))},{default:t(()=>[v(T(m.btnText),1)]),_:1},8,["type","disabled"])])]),_:1})]),_:1},8,["model","rules"])]),_:1}),l(V,{label:"邮箱登陆",name:"email"},{default:t(()=>[l(x,{model:g,ref_key:"emailFormRef",ref:F,rules:A,style:{width:"100%"}},{default:t(()=>[l(d,{prop:"email"},{default:t(()=>[l(s,{modelValue:g.email,"onUpdate:modelValue":e[8]||(e[8]=a=>g.email=a),modelModifiers:{trim:!0},placeholder:"请输入邮箱",clearable:"","prefix-icon":c(R),size:"large",style:{width:"100%"}},null,8,["modelValue","prefix-icon"])]),_:1}),l(d,{prop:"code"},{default:t(()=>[n("div",Ce,[l(s,{modelValue:g.code,"onUpdate:modelValue":e[9]||(e[9]=a=>g.code=a),modelModifiers:{trim:!0},placeholder:"请输入验证码",type:"password","prefix-icon":c(C),size:"large"},null,8,["modelValue","prefix-icon"]),Te,l(k,{link:"",type:u.type,class:"btnCode",disabled:u.disabled,onClick:e[10]||(e[10]=a=>P(u))},{default:t(()=>[v(T(u.btnText),1)]),_:1},8,["type","disabled"])])]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["modelValue"]),n("div",Ie,[l(H,{direction:"vertical",size:15,alignment:"normal",style:{width:"100%"}},{default:t(()=>[l(k,{type:"primary",size:"large",class:"loginBtn",onClick:M,loading:h.value},{default:t(()=>[v(T(j.value(h.value)),1)]),_:1},8,["loading"]),n("div",ze,[l(B,{to:"/member/register"},{default:t(()=>[l(U,{type:"primary"},{default:t(()=>[v("没有账号我要免费注册>>")]),_:1})]),_:1})])]),_:1})])])])}}};export{Ue as default};
